(self.webpackChunkblog=self.webpackChunkblog||[]).push([[505],{59505:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return U}});n(92222),n(26541),n(57327),n(21249),n(5212),n(68309),n(73210),n(35666);var r=n(63804),a=n.n(r),o=n(15862),i=n(80051),l=n(48086),u=n(71230),c=n(15746),s=n(71577),f=n(62529),m=n(69713),d=n(61606),y=n(90753),p=n(60331),v=n(49101),b=n(59879),g=n(73171),h=n(58988),E=n(2603),O=n(59271),k=n(12470),S=n.n(k),w=n(59781),Z=n(10327),j=(n(82772),n(47941),n(82482)),x=n(3785),C=n(71113);function P(){return(P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){A(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function A(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function M(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return z(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function L(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var _=(0,r.memo)((function(e){var t=e.initialValues,n=e.visible,o=e.allSortList,i=e.onSave,u=e.onToggleEditorialPanel,c=L(e,["initialValues","visible","allSortList","onSave","onToggleEditorialPanel"]),s=M(j.Z.useForm(),1)[0],f=(0,r.useCallback)((function(){s.resetFields(),u()}),[s,u]),m=(0,r.useCallback)((function(){s.validateFields().then((function(e){var n=e.sort,r=L(e,["sort"]);i(I({id:null==t?void 0:t.id,sortId:n.key},r),(function(){s.resetFields(),u()}))})).catch((function(e){l.ZP.error(e.message)}))}),[s,t,i,u]),y=(0,r.useMemo)((function(){var e=t||{},n=e.name,r=e.isEnable,a=void 0===r?1:r,o=e.sort;return I(I({},{isEnable:a,name:n}),{},{sort:o?{label:o.name,key:o.id}:void 0})}),[t]);return a().createElement(x.Z,P({destroyOnClose:!0,title:null!=t&&t.id?"更新":"添加",visible:n,onOk:m,onCancel:f,maskClosable:!1},c),a().createElement(j.Z,{labelCol:{span:5},wrapperCol:{span:17},form:s,initialValues:y},a().createElement(j.Z.Item,{label:"名称",name:"name",rules:[{required:!0,message:"请输入名称!"}]},a().createElement(d.Z,null)),a().createElement(j.Z.Item,{label:"所属",name:"sort",rules:[{required:!0,message:"请选择状态!"}]},a().createElement(C.Z,{labelInValue:!0},o.map((function(e){return a().createElement(C.Z.Option,{key:e.id,value:e.id},e.name)})))),a().createElement(j.Z.Item,{label:"状态",name:"isEnable",rules:[{required:!0,message:"请选择状态!"}],style:{marginBottom:0}},a().createElement(C.Z,null,a().createElement(C.Z.Option,{value:1},"可用"),a().createElement(C.Z.Option,{value:0},"不可用")))))}));function V(e,t,n,r,a,o,i){try{var l=e[o](i),u=l.value}catch(e){return void n(e)}l.done?t(u):Promise.resolve(u).then(r,a)}function R(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){V(o,r,a,i,l,"next",e)}function l(e){V(o,r,a,i,l,"throw",e)}i(void 0)}))}}function T(e){return function(e){if(Array.isArray(e))return q(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||K(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){N(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function N(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function B(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw o}}return n}(e,t)||K(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function K(e,t){if(e){if("string"==typeof e)return q(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?q(e,t):void 0}}function q(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var U=(0,r.memo)((function(){var e=(0,r.useRef)(null),t=B((0,r.useState)([]),2),n=t[0],k=t[1],j=B((0,r.useState)({current:1,pageSize:10}),2),x=j[0],C=j[1],P=B((0,r.useState)([]),2),D=P[0],I=P[1],A=B((0,r.useState)({}),2),M=A[0],z=A[1],L=B((0,r.useState)({}),2),V=L[0],Y=L[1],N=B((0,r.useState)(!1),2),K=N[0],q=N[1],U=B((0,r.useState)(null),2),Q=U[0],$=U[1],G=(0,r.useMemo)((function(){return{index:x.current,size:x.pageSize,conditionQuery:M}}),[x,M]),J=B((0,i.G2)(Z._.getList,G),4),H=J[0],W=J[1],X=J[2],ee=J[3],te=B((0,r.useMemo)((function(){var e,t;return X?(l.ZP.error(X.message||"获取列表失败"),[0,[]]):[(null==W||null===(e=W.data)||void 0===e?void 0:e.total)||0,(null==W||null===(t=W.data)||void 0===t?void 0:t.list)||[]]}),[W,X]),2),ne=te[0],re=te[1],ae=(0,r.useCallback)((function(){var t,n;z({}),Y({}),null===(t=e.current)||void 0===t||null===(n=t.setValue)||void 0===n||n.call(t,""),C((function(e){return F(F({},e),{},{current:1})}))}),[]),oe=(0,r.useCallback)((function(e){C((function(e){return F(F({},e),{},{current:1})})),z((function(t){return F(F({},t),{},{name:e.trim()})}))}),[]),ie=(0,r.useCallback)((function(e,t){var r=[];r=n.length===e.length?t:n.length<e.length?[].concat(T(n.filter((function(e){return t.every((function(t){return e.id!==t.id}))}))),T(t)):n.filter((function(t){return e.some((function(e){return e===t.id}))})),k(r)}),[n]),le=(0,r.useCallback)((function(e,t,n){var r;C({current:e.current,pageSize:e.pageSize});var a=n,o=a.columnKey,i=a.order,l=i?{name:o,by:"descend"===i?"DESC":"ASC"}:{},u=null==t||null===(r=t.isEnable)||void 0===r?void 0:r[0],c=(null==t?void 0:t.sort)||[];Y(t),z((function(e){return F(F({},e),{},{orderBy:l,isEnable:u,sortIdsArr:c})}))}),[]),ue=(0,r.useCallback)(function(){var e=R(regeneratorRuntime.mark((function e(t,r){var a,o,i,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(r?[r]:n).map((function(e){return{id:e.id,name:e.name}})),e.next=3,Z._[t]({items:a});case 3:if(o=e.sent,i=B(o,2),!i[1]){e.next=9;break}return l.ZP.error("操作失败"),e.abrupt("return");case 9:l.ZP.success("操作成功"),k([]),u=x.current,"remove"===t&&(null==a?void 0:a.length)>(null==re?void 0:re.length)?C((function(e){return F(F({},e),{},{current:u-1||0})})):ee();case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[x,n,re,ee]),ce=(0,r.useCallback)((function(e){$(e),q((function(e){return!e}))}),[]),se=(0,r.useCallback)(function(){var e=R(regeneratorRuntime.mark((function e(t,n){var r,a,o,i,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l.ZP.loading({content:"正在提交...",key:"saveData",duration:0}),e.next=3,Z._.save(t);case 3:if(r=e.sent,a=B(r,2),!(o=a[1])){e.next=9;break}return l.ZP.error({content:o.message||"提交失败",key:"saveData"}),e.abrupt("return");case 9:n&&n(),i=x.pageSize,u=x.current,t.id||(null==re?void 0:re.length)!==i?ee():C((function(e){return F(F({},e),{},{current:u+1})})),l.ZP.success({content:"操作成功",key:"saveData"});case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[re,x,ee]);(0,r.useEffect)((function(){R(regeneratorRuntime.mark((function e(){var t,n,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.I.getList({index:1,size:999});case 2:n=e.sent,r=B(n,1),a=r[0],I((null==a||null===(t=a.data)||void 0===t?void 0:t.list)||[]);case 6:case"end":return e.stop()}}),e)})))()}),[]);var fe=(0,r.useMemo)((function(){return a().createElement(u.Z,{align:"middle",style:{marginBottom:15}},a().createElement(c.Z,{xs:12,sm:13,md:15,lg:16,xl:17},a().createElement(s.Z,{icon:a().createElement(v.Z,null),type:"primary",size:"small",onClick:function(){ce()}},"新增"),(null==n?void 0:n.length)>0&&a().createElement(a().Fragment,null,a().createElement(f.Z,{count:n.length,title:"已选项数"},a().createElement(s.Z,{icon:a().createElement(b.Z,null),type:"primary",size:"small",onClick:function(){k([])},style:{marginLeft:10}},"清空")),a().createElement(s.Z,{icon:a().createElement(g.Z,null),type:"primary",danger:!0,size:"small",onClick:function(){ue("remove")},style:{marginLeft:10}},"删除"),a().createElement(s.Z,{icon:a().createElement(h.Z,null),type:"primary",size:"small",onClick:function(){ue("unlock")},style:{marginLeft:10}},"启用"),a().createElement(s.Z,{icon:a().createElement(E.Z,null),type:"primary",size:"small",onClick:function(){ue("lock")},style:{marginLeft:10}},"禁用"))),a().createElement(c.Z,{xs:2,sm:2,md:1,lg:1,xl:1},a().createElement(m.Z,{title:"默认展示"},a().createElement(s.Z,{type:"primary",icon:a().createElement(O.Z,null),shape:"circle",size:"small",onClick:ae}))),a().createElement(c.Z,{xs:10,sm:9,md:8,lg:7,xl:6},a().createElement(d.Z.Search,{ref:e,placeholder:"Enter something",onSearch:oe,enterButton:!0,allowClear:!0})))}),[n,ce,ue,oe,ae]),me=(0,r.useMemo)((function(){return a().createElement(y.Z,{columns:[{title:"名称",dataIndex:"name",key:"name",sorter:!0},{title:"所属",dataIndex:"sort",key:"sort",sorter:!0,filters:D.map((function(e){return{text:e.name,value:e.id}})),filteredValue:(null==V?void 0:V.sort)||[],render:function(e){return null==e?void 0:e.name}},{title:"创建时间",dataIndex:"createDate",key:"createDate",sorter:!0,render:function(e){return S()(new Date(e)).format("YYYY-MM-DD")}},{title:"修改时间",dataIndex:"updateDate",key:"updateDate",sorter:!0,render:function(e){return S()(new Date(e)).format("YYYY-MM-DD")}},{title:"状态",dataIndex:"isEnable",key:"isEnable",sorter:!0,filters:[{text:"不可用",value:0},{text:"可用",value:1}],filterMultiple:!1,filteredValue:(null==V?void 0:V.isEnable)||[],render:function(e){return a().createElement(p.Z,{color:1===e?"blue":"gray"},1===e?"可用":"不可用")}},{title:"操作",key:"action",render:function(e){return a().createElement(a().Fragment,null,a().createElement(s.Z,{size:"small",type:"primary",onClick:function(){ce(e)}},"编辑"),a().createElement(s.Z,{size:"small",danger:!0,type:"primary",onClick:function(){ue("remove",e)},style:{marginLeft:10}},"删除"),a().createElement(s.Z,{size:"small",type:"primary",onClick:function(){ue(e.isEnable?"lock":"unlock",e)},style:{marginLeft:10}},e.isEnable?"禁用":"启用"))}}],rowKey:"id",onChange:le,rowSelection:{selectedRowKeys:n.map((function(e){return e.id})),onChange:ie},loading:H,dataSource:re,pagination:F({showQuickJumper:!0,showSizeChanger:!0,total:ne},x)})}),[ne,D,V,n,H,re,x,le,ie,ue,ce]),de=(0,r.useMemo)((function(){return K?a().createElement(_,{visible:K,initialValues:Q,allSortList:D.filter((function(e){return Boolean(e.isEnable)})),onSave:se,onToggleEditorialPanel:ce}):null}),[K,Q,D,ce,se]);return a().createElement(o.F_,null,fe,me,de)}))},59781:function(e,t,n){"use strict";n.d(t,{I:function(){return r}});var r={};n.r(r),n.d(r,{getList:function(){return i},lock:function(){return c},remove:function(){return u},save:function(){return l},unlock:function(){return s}});var a=n(85344),o=n(94036);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.v_)(o.xx.ADMIN_LIST,e)}function l(e){return(0,a.v_)(o.xx.ADMIN_SAVE,e)}function u(e){return(0,a.v_)(o.xx.ADMIN_DELETE,e)}function c(e){return(0,a.v_)(o.xx.ADMIN_LOCK,e)}function s(e){return(0,a.v_)(o.xx.ADMIN_UNLOCK,e)}}}]);
//# sourceMappingURL=505.js.map